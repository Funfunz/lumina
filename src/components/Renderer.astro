---
import type { IComponentData, IPageData } from '../data/data'
import { getComponent } from '../helpers/componentLib'
import RendererWrapper from './RendererWrapper.astro'

interface Props {
	data: IComponentData | IPageData;
  edit?: boolean
}

const { data, edit } = Astro.props;


const toRender = (data: IComponentData[]) => {
  return data.map(
    (child) => {
      const Component = getComponent(child.type)
      if (!Component) {
        return
      }
      return {
        Component,
        data: child,
      }
    }
  ).filter(e => e)
}

---

{toRender(data.children).map(
  ({Component, data}) => {
    return (
      <Component edit={edit} {...data.props}>
        {data.children && <RendererWrapper data={data} edit={edit}/>}
      </Component>
    )
  }
)}
