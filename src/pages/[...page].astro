---
import {getPageData, getPages, getPagesId} from '../helpers/dataFetcher'
import AstroRenderer from '../components/AstroRenderer.astro'
import { ViewTransitions } from 'astro:transitions'
import Layout from '../layout/Layout.astro';

export async function getStaticPaths() {
  return (await getPagesId()).map(
		(page) => ({params: {page: page === "homeroot" ? undefined : page}})
	)
}

const pages = await getPages()

const { page } = Astro.params;

const pageData = await getPageData(page)
---
<ViewTransitions />
<Layout data={pageData} pages={pages} selectedPage={page}>
	<AstroRenderer data={pageData}/>
</Layout>
