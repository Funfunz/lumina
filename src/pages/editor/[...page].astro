---
import {getPageData, getPages, getPagesId} from '../../helpers/dataFetcher'
import AstroRenderer from '../../components/AstroRenderer.astro'
import Layout from '../../layout/Layout.astro'
import { ViewTransitions } from 'astro:transitions'



export async function getStaticPaths() {
  return (await getPagesId()).map(
		(page) => ({params: {page: page === "homeroot" ? undefined : page}})
	)
}

const pages = await getPages()

const { page } = Astro.params;

const pageData = await getPageData(page)
---
<ViewTransitions />
<Layout edit={true} data={JSON.parse(JSON.stringify(pageData))} pages={pages} selectedPage={page}>
	<AstroRenderer data={JSON.parse(JSON.stringify(pageData))} edit={true}/>
</Layout>